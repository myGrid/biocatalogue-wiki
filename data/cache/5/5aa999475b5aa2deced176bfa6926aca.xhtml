
<p>
<strong>IMPORTANT NOTE (2010-04-13):</strong> The WSDUtils component does not work with PHP 5.3 and greater. PHP 5.3 introduces the notion of “namespaces”, but the WSDLUtils defines “Namespace” as a class and therefore PHP 5.3 borks when loading up the files. (See: <a href="http://forums.developer.mindtouch.com/showthread.php?t=6059" class="urlextern" target="_blank" title="http://forums.developer.mindtouch.com/showthread.php?t=6059"  rel="nofollow">http://forums.developer.mindtouch.com/showthread.php?t=6059</a> for an example).
</p>

<p>
Full documentation for the WSDLUtils component is available here: <a href="/wiki/_media/development:wsdltoolsrest.pdf" class="media mediafile mf_pdf" title="development:wsdltoolsrest.pdf (331.7 KB)">here</a>
</p>

<h1 class="sectionedit1" id="wsdl_parsing">WSDL Parsing</h1>
<div class="level1">

<p>
<a href="http://www.w3.org/TR/wsdl" class="urlextern" target="_blank" title="http://www.w3.org/TR/wsdl"  rel="nofollow">WSDL</a> parsing in BioCatalogue involves reading the contents of a WSDL file and structuring the data from it so that it can be mapped to the data model used internally in the BioCatalogue (which is subsequently persisted to a relational database). This structured way of storing the data contents allows for individual pieces of the data to be annotated separately.<br/>

The main elements in the WSDL documents are :
</p>
<ul>
<li class="level1"><div class="li"> the types</div>
</li>
<li class="level1"><div class="li"> the messages</div>
</li>
<li class="level1"><div class="li"> the portTypes</div>
</li>
<li class="level1"><div class="li"> the bindings</div>
</li>
<li class="level1"><div class="li"> the services</div>
</li>
</ul>

<p>
The WSDL parsing process in BioCatalogue also involves the mapping of the service elements with the operations within the portypes, the mapping of the messages with the types used in the messages to build a hierarchy of service, operations and operations/outputs.
</p>

<p>
The BioCatalogue view of the WSDL is a tree-like structure with the service at the root node. The operations as defined within the portType elements are attached to this root node. The messages used by the input and outputs of these operations form the leaves of the structure. The <a href="/wiki/_media/development:wsdl_parsing1.ppt" class="media mediafile mf_ppt" title="development:wsdl_parsing1.ppt (49 KB)">wsdl parsing document</a> shows how the mapping is done.
</p>

<p>
The building of the service hierarchy used in BioCatalogue is achieved in a two stage process:
</p>
<ul>
<li class="level1"><div class="li"> Using the WSDLUtils library from the EMBRACE registry to generate a simplified xml document. The main advantage of using this library is that the types defined in external xml schemas are imported. Importing types defined in external schemas permits details of complex types to be obtained. Often important bits of information for the end users, like the documentation of the types used by the service is hidden in these external schemas. Documentation (including installation instructions) for the WSDLUtils library is available <a href="/wiki/_media/development:wsdltoolsrest.pdf" class="media mediafile mf_pdf" title="development:wsdltoolsrest.pdf (331.7 KB)">here</a>. This library has a rest interface and is currently installed on BioCatalogue <a href="http://test.biocatalogue.org" class="urlextern" target="_blank" title="http://test.biocatalogue.org"  rel="nofollow">test server</a>. To use the wsdl parser, we pass it two parameters : </div>
<ul>
<li class="level2"><div class="li"> the method name</div>
</li>
<li class="level2"><div class="li"> the wsdl uri <br/>
Example: <br/>
<a href="http://test.biocatalogue.org/WSDLUtils/WSDLUtils.php?method=parse&amp;wsdl_uri=http://bioit.fleming.gr/mrb/service?ws=mrbws" class="urlextern" target="_blank" title="http://test.biocatalogue.org/WSDLUtils/WSDLUtils.php?method=parse&amp;wsdl_uri=http://bioit.fleming.gr/mrb/service?ws=mrbws"  rel="nofollow"> Parse the mrbws service</a></div>
</li>
</ul>
</li>
</ul>
<ul>
<li class="level1"><div class="li"> The xml file generated by the WSDLUtils  library is then transformed into a ruby structure for storing in the BioCatalogue database. The the structures is as shown in <a href="/wiki/_media/development:wsdl_parsing1.ppt" class="media mediafile mf_ppt" title="development:wsdl_parsing1.ppt (49 KB)">wsdl parsing document</a> </div>
</li>
</ul>

</div>
<!-- EDIT1 SECTION "WSDL Parsing" [439-2909] -->
<h3 class="sectionedit2" id="configuration">Configuration</h3>
<div class="level3">

<p>
Set the WSDLUtils parser loaction in 
</p>
<pre class="code">config/initializers/biocat_local.rb</pre>

<p>
Example 
</p>
<pre class="code">WSDLUTILS_BASE_URI = &#039;http://test.biocatalogue.org/WSDLUtils/WSDLUtils.php&#039;</pre>

</div>
<!-- EDIT2 SECTION "Configuration" [2910-3118] -->
<h3 class="sectionedit3" id="run_parser_in_console">Run Parser in Console</h3>
<div class="level3">
<pre class="code"> BioCatalogue::WSDLUtils::WSDLParser.parse(&quot;wsdl_url&quot;)</pre>

</div>
<!-- EDIT3 SECTION "Run Parser in Console" [3119-3220] -->
<h3 class="sectionedit4" id="example">Example</h3>
<div class="level3">

<p>
The <a href="http://bioit.fleming.gr/mrb/service?ws=mrbws" class="urlextern" target="_blank" title="http://bioit.fleming.gr/mrb/service?ws=mrbws"  rel="nofollow">mrbws wsdl</a> when parsed will produce:
</p>
<pre class="code">
{&quot;name&quot;=&gt;&quot;Mrbws&quot;,
 &quot;end_point&quot;=&gt;&quot;http://bioit.fleming.gr/mrb/mrbws&quot;,
 &quot;operations&quot;=&gt;
  [{&quot;operation_type&quot;=&gt;nil,
    &quot;name&quot;=&gt;&quot;getCategories&quot;,
    &quot;inputs&quot;=&gt;
     [{&quot;computational_type&quot;=&gt;&quot;getCategories&quot;,
       &quot;name&quot;=&gt;&quot;getCategories&quot;,
       &quot;computational_type_details&quot;=&gt;
        {&quot;type&quot;=&gt;
          {&quot;name&quot;=&gt;&quot;getCategories&quot;, &quot;type&quot;=&gt;{&quot;name&quot;=&gt;&quot;getCategories&quot;}}}}],
    &quot;parent_port_type&quot;=&gt;&quot;mrbwsSEIPort&quot;,
    &quot;action&quot;=&gt;nil,
    &quot;description&quot;=&gt;nil,
    &quot;outputs&quot;=&gt;
     [{&quot;computational_type&quot;=&gt;&quot;getCategoriesResponse&quot;,
       &quot;name&quot;=&gt;&quot;getCategoriesResponse&quot;,
       &quot;computational_type_details&quot;=&gt;
        {&quot;type&quot;=&gt;
          {&quot;name&quot;=&gt;&quot;getCategoriesResponse&quot;,
           &quot;type&quot;=&gt;
            {&quot;name&quot;=&gt;&quot;getCategoriesResponse&quot;,
             &quot;type&quot;=&gt;{&quot;name&quot;=&gt;&quot;result&quot;, &quot;type&quot;=&gt;{&quot;name&quot;=&gt;&quot;string&quot;}}}}}}]},
   {&quot;operation_type&quot;=&gt;nil,
    &quot;name&quot;=&gt;&quot;getNonOboOntologies&quot;,
    &quot;inputs&quot;=&gt;
     [{&quot;computational_type&quot;=&gt;&quot;getNonOboOntologies&quot;,
       &quot;name&quot;=&gt;&quot;getNonOboOntologies&quot;,
       &quot;computational_type_details&quot;=&gt;
        {&quot;type&quot;=&gt;
          {&quot;name&quot;=&gt;&quot;getNonOboOntologies&quot;,
           &quot;type&quot;=&gt;{&quot;name&quot;=&gt;&quot;getNonOboOntologies&quot;}}}}],
    &quot;parent_port_type&quot;=&gt;&quot;mrbwsSEIPort&quot;,
    &quot;action&quot;=&gt;nil,
    &quot;description&quot;=&gt;nil,
    &quot;outputs&quot;=&gt;
     [{&quot;computational_type&quot;=&gt;&quot;getNonOboOntologiesResponse&quot;,
       &quot;name&quot;=&gt;&quot;getNonOboOntologiesResponse&quot;,
       &quot;computational_type_details&quot;=&gt;
        {&quot;type&quot;=&gt;
          {&quot;name&quot;=&gt;&quot;getNonOboOntologiesResponse&quot;,
           &quot;type&quot;=&gt;
            {&quot;name&quot;=&gt;&quot;getNonOboOntologiesResponse&quot;,
             &quot;type&quot;=&gt;{&quot;name&quot;=&gt;&quot;result&quot;, &quot;type&quot;=&gt;{&quot;name&quot;=&gt;&quot;string&quot;}}}}}}]},
   {&quot;operation_type&quot;=&gt;nil,
    &quot;name&quot;=&gt;&quot;getQualityCriteria&quot;,
    &quot;inputs&quot;=&gt;
     [{&quot;computational_type&quot;=&gt;&quot;getQualityCriteria&quot;,
       &quot;name&quot;=&gt;&quot;getQualityCriteria&quot;,
       &quot;computational_type_details&quot;=&gt;
        {&quot;type&quot;=&gt;
          {&quot;name&quot;=&gt;&quot;getQualityCriteria&quot;,
           &quot;type&quot;=&gt;{&quot;name&quot;=&gt;&quot;getQualityCriteria&quot;}}}}],
    &quot;parent_port_type&quot;=&gt;&quot;mrbwsSEIPort&quot;,
    &quot;action&quot;=&gt;nil,
    &quot;description&quot;=&gt;nil,
    &quot;outputs&quot;=&gt;
     [{&quot;computational_type&quot;=&gt;&quot;getQualityCriteriaResponse&quot;,
       &quot;name&quot;=&gt;&quot;getQualityCriteriaResponse&quot;,
       &quot;computational_type_details&quot;=&gt;
        {&quot;type&quot;=&gt;
          {&quot;name&quot;=&gt;&quot;getQualityCriteriaResponse&quot;,
           &quot;type&quot;=&gt;
            {&quot;name&quot;=&gt;&quot;getQualityCriteriaResponse&quot;,
             &quot;type&quot;=&gt;{&quot;name&quot;=&gt;&quot;result&quot;, &quot;type&quot;=&gt;{&quot;name&quot;=&gt;&quot;string&quot;}}}}}}]},
   {&quot;operation_type&quot;=&gt;nil,
    &quot;name&quot;=&gt;&quot;getResourcesByCategory&quot;,
    &quot;inputs&quot;=&gt;
     [{&quot;computational_type&quot;=&gt;&quot;getResourcesByCategory&quot;,
       &quot;name&quot;=&gt;&quot;getResourcesByCategory&quot;,
       &quot;computational_type_details&quot;=&gt;
        {&quot;type&quot;=&gt;
          {&quot;name&quot;=&gt;&quot;getResourcesByCategory&quot;,
           &quot;type&quot;=&gt;
            {&quot;name&quot;=&gt;&quot;getResourcesByCategory&quot;,
             &quot;type&quot;=&gt;{&quot;name&quot;=&gt;&quot;int_1&quot;, &quot;type&quot;=&gt;{&quot;name&quot;=&gt;&quot;int&quot;}}}}}}],
    &quot;parent_port_type&quot;=&gt;&quot;mrbwsSEIPort&quot;,
    &quot;action&quot;=&gt;nil,
    &quot;description&quot;=&gt;nil,
    &quot;outputs&quot;=&gt;
     [{&quot;computational_type&quot;=&gt;&quot;getResourcesByCategoryResponse&quot;,
       &quot;name&quot;=&gt;&quot;getResourcesByCategoryResponse&quot;,
       &quot;computational_type_details&quot;=&gt;
        {&quot;type&quot;=&gt;
          {&quot;name&quot;=&gt;&quot;getResourcesByCategoryResponse&quot;,
           &quot;type&quot;=&gt;
            {&quot;name&quot;=&gt;&quot;getResourcesByCategoryResponse&quot;,
             &quot;type&quot;=&gt;{&quot;name&quot;=&gt;&quot;result&quot;, &quot;type&quot;=&gt;{&quot;name&quot;=&gt;&quot;string&quot;}}}}}}]},
   {&quot;operation_type&quot;=&gt;nil,
    &quot;name&quot;=&gt;&quot;getWSDLs&quot;,
    &quot;inputs&quot;=&gt;
     [{&quot;computational_type&quot;=&gt;&quot;getWSDLs&quot;,
       &quot;name&quot;=&gt;&quot;getWSDLs&quot;,
       &quot;computational_type_details&quot;=&gt;
        {&quot;type&quot;=&gt;{&quot;name&quot;=&gt;&quot;getWSDLs&quot;, &quot;type&quot;=&gt;{&quot;name&quot;=&gt;&quot;getWSDLs&quot;}}}}],
    &quot;parent_port_type&quot;=&gt;&quot;mrbwsSEIPort&quot;,
    &quot;action&quot;=&gt;nil,
    &quot;description&quot;=&gt;nil,
    &quot;outputs&quot;=&gt;
     [{&quot;computational_type&quot;=&gt;&quot;getWSDLsResponse&quot;,
       &quot;name&quot;=&gt;&quot;getWSDLsResponse&quot;,
       &quot;computational_type_details&quot;=&gt;
        {&quot;type&quot;=&gt;
          {&quot;name&quot;=&gt;&quot;getWSDLsResponse&quot;,
           &quot;type&quot;=&gt;
            {&quot;name&quot;=&gt;&quot;getWSDLsResponse&quot;,
             &quot;type&quot;=&gt;{&quot;name&quot;=&gt;&quot;result&quot;, &quot;type&quot;=&gt;{&quot;name&quot;=&gt;&quot;string&quot;}}}}}}]}],
 &quot;namespace&quot;=&gt;&quot;urn:mrbws/wsdl&quot;,
 &quot;description&quot;=&gt;nil,
 &quot;ports&quot;=&gt;
  [{&quot;name&quot;=&gt;&quot;mrbwsSEIPort&quot;,
    &quot;protocol&quot;=&gt;&quot;http://schemas.xmlsoap.org/soap/http&quot;,
    &quot;location&quot;=&gt;&quot;http://bioit.fleming.gr/mrb/mrbws&quot;,
    &quot;style&quot;=&gt;&quot;document&quot;}]}

</pre>

</div>
<!-- EDIT4 SECTION "Example" [3221-7469] -->
<h3 class="sectionedit5" id="biocatalogue_model_extensions">BioCatalogue Model Extensions</h3>
<div class="level3">
<pre class="code">  New Model : Soap Service Port 
  Table Name : soap_service_ports 
  Fields :
    * name  
    * protocol
    * location
    * style</pre>
<pre class="code">  New Model Attribute : computational_type_details 
  Table Name : soap_inputs,soap_outputs 
  Fields :
    * computational_type_details
    Computational type details are the details of complex types defined either inline or in an external schema. They are stored in the db as a
    serialized ruby hash</pre>

</div>
<!-- EDIT5 SECTION "BioCatalogue Model Extensions" [7470-7979] -->
<h3 class="sectionedit6" id="known_issues">Known Issues</h3>
<div class="level3">
<ul>
<li class="level1"><div class="li"> The WSDLUtils library fails to parse WSDLs with schema locations specified with relative paths. Examples include the NCBI soap services like <pre class="code"> http://www.ncbi.nlm.nih.gov/entrez/eutils/soap/eutils.wsdl </pre>
</div>
</li>
</ul>

</div>
<!-- EDIT6 SECTION "Known Issues" [7980-] -->